#include <iostream>

#include "Lua.hpp"
#include "Dump.h"

int main()
{
	/****************************************************************************************************************
	 *
	 *    Brief   : 初始化和加载Lua库
	 *
	 ****************************************************************************************************************/
	lua_State *L = luaL_newstate();
	luaL_openlibs(L);

	/****************************************************************************************************************
	 *
	 *    Brief   : 直接调用Lua代码。
	 *
	 ****************************************************************************************************************/
	luaL_dostring(L, "print('Hello Lua!')");

	/****************************************************************************************************************
	 *
	 *    Brief   : 调用Lua文件中的函数。
	 *
	 ****************************************************************************************************************/
	luaL_dofile(L, "main.lua");
	lua_getglobal(L, "Add");				DumpStack(L);
	lua_pushinteger(L, 3);					DumpStack(L);
	lua_pushinteger(L, 6);					DumpStack(L);
	lua_call(L, 2, 1);						DumpStack(L);
	int num = (int)lua_tointeger(L, -1);	DumpStack(L);
	lua_pop(L, 1);							DumpStack(L);
	printf("Result = %d\n", num);

	/****************************************************************************************************************
	 *
	 *    Brief   : 销毁
	 *
	 ****************************************************************************************************************/
	lua_close(L);

	system("pause");
	return 0;
}